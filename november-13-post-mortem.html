
<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" type="text/css" href="_pagefind/pagefind-ui.css">
        <script type="text/javascript" src="_pagefind/pagefind-ui.js"></script>
        <style>:root {
  --pagefind-ui-scale: 1;
  --pagefind-ui-primary: #034ad8;
  --pagefind-ui-text: #ebdbb2;
  --pagefind-ui-background: #3c3836;
  --pagefind-ui-border: #eeeeee;
  --pagefind-ui-tag: #034ad8;
  --pagefind-ui-border-width: 2px;
  --pagefind-ui-border-radius: 8px;
  ----pagefind-ui-image-border-radius: 8px;
  --pagefind-ui-image-box-ratio: 3 / 2;
  --pagefind-ui-font: inherit; }

main {
  -webkit-font-feature-settings: "liga" on, "calt" on;
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
  font-family: 'JetBrains Mono', 'Input Mono', monospace;
  max-width: 38rem;
  padding: 2rem;
  margin: auto; }

@media only screen and (max-device-width: 736px) {
  main {
    padding: 0.2rem; } }

::selection {
  background: #9c0018; }

body {
  background: #282828;
  color: #ebdbb2; }

pre {
  background-color: #3c3836;
  padding: 1em;
  border: 0;
  overflow: auto;
  white-space: pre-wrap; }

a, a:active, a:visited {
  color: #e491b6;
  background-color: #1d2021; }

h1, h2, h3, h4, h5 {
  margin-bottom: .1rem; }

blockquote {
  border-left: 1px solid #bdae93;
  margin: 0.5em 10px;
  padding: 0.5em 10px; }

footer {
  align: center; }

img {
  max-width: 100%; }
</style>
        <script>
            window.addEventListener('DOMContentLoaded', (event) => { new PagefindUI({ element: "#search" }); });
        </script>
        <title>november 13 post mortem</title>
    </head>

    <body>
        <main>
            <div id="search"></div>
    <h1 data-pagefind-meta="title"><a href="./november-13-post-mortem.html">november 13 post mortem</a></h1>

    <time>Tue, 13 Nov 2018 20:20 UTC</time>
    <p>tags:</p>
     
<ul data-pagefind-meta="tags">
     <li>
        <a href="tags/post-mortem.html">post-mortem</a>
    </li> <li>
        <a href="tags/linux.html">linux</a>
    </li> <li>
        <a href="tags/sysadmin.html">sysadmin</a>
    </li></ul>



    <hr>

    <div data-pagefind-body>
    <p>we had something of an outage on november 13, 2018 on tilde.team.</p>
<p>i awoke, not suspecting anything to be amiss. as soon as i logged in to
check my email and irc mentions, it became clear.</p>
<p>tilde.team was at the least inaccessible, and at the worst, down
completely. according the message in my inbox, there had been an
attempted &ldquo;attack&rdquo; from my IP.</p>
<!-- raw HTML omitted -->
<blockquote>
<p>We have indications that there was an attack from your server. Please
take all necessary measures to avoid this in the future and to solve
the issue.</p>
</blockquote>
<p>at this point, i have no idea what could have happened over night while
i&rsquo;m sleeping. the timestamp shows that it arrive only 30 minutes after
i&rsquo;d turned in for the night.</p>
<p>when i finally log on in the morning to check mails and irc mentions, i
find that i&rsquo;m unable to connect to tilde.team&hellip; strange, but ok; time
to troubleshoot. i refresh the <a href="https://mail.tilde.team">webmail</a> to see
what i&rsquo;m missing. it ends up failing to find the server. even stranger!
i&rsquo;d better get the mails off my phone if they&rsquo;re on my @tilde.team mail!</p>
<p>here, i launch in to full debugging mode: what command was it? who ran
it?</p>
<p>search <code>~/.bash_history</code> per user was not very successful. nothing i
could find was related to net or map. i had checked
<code>sudo grep nmap /home/*/.bash_history</code> and many other commands.</p>
<p>at this point, i had connected with other ~teammates across other irc
nets (<a href="https://hashbang.sh/">#!</a>, <a href="https://tilde.town">~town</a>, etc).
among suggestions to check <code>/var/log/syslog</code>, <code>/var/log/kern.log</code>, and
<code>dmesg</code>, i finally decided to check <code>ps</code>. <code>ps -ef | grep nmap</code> yielded
nmap on an obscured uid and gid, which is shortly established to belong
to a container i had provisioned for <a href="/~fosslinux/">~fosslinux</a>.</p>
<p>i&rsquo;m not considering methods of policing access to any site over port 80
and port 443. this is crazy. how do you police <code>nmap</code> when it isn&rsquo;t
scanning on every port?</p>
<p>after a bit of shit-talking and reassurance from other sysadmins, i
reexamined and realized that <a href="/~fosslinux/">~fosslinux</a> had only run
<code>nmap</code> for addresses in the <code>10.0.0.0/8</code> space. the <code>10/8</code> address space
is intended to not be addressable outside the local space. how could
<a href="https://hetzner.com">hetzner</a> have found out about a localhost network
probe!?</p>
<p>finally, after speaking with more people than i expected to speak with
in one day, i ended up sending three different support emails to hetzner
support, which finally resulted in them unlocking the ip.</p>
<p>it&rsquo;s definitely time to research redundancy options!</p>

    </div>

	<script src="https://utteranc.es/client.js"
        repo="benharri/blog"
        issue-term="title"
        crossorigin="anonymous"
        theme="github-dark"
        async>
	</script>

<footer>
    CC by-nc-nd <a href="https://tilde.team/~ben/">~ben</a> &mdash; <a href="https://tildegit.org/ben/blog">site source</a>
</footer>
</main>
    </body>
</html>
